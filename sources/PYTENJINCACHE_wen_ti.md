title: PYTENJIN CACHE问题
date:  2014-02-05 15:40:08
file:  PYTENJINCACHE_wen_ti.md
tags: 
- blog
- Network
- python
memo: 
- ":"号与"-"号紧接着至少一个空格
- tags可以用memo的无序列表方式，也可以删除 "- notag" 行，然后用同一行的方式，多tag用","号分隔，如"tags: tag1, tag2"
- 正文与文件参数用空行分隔
- memo不算字数...file与memo也不参与文章发布。这二项目都可以在模板文件init.md中删除。
- ahui at ahui.us,2014

Tenjin是个好模板. (签名)

满足我喜欢的三个要求：

- 快速
- HTML友好
- 能直接用python代码。

当然能直接用python代码是件好事也是件坏事。

在做静态html生成程序时，因为动态生成了不同内容的同名模板，导致Tenjin解析时总是取缓存中的内容。
Tenjin对1秒内生成的缓存文件总是做有效处理，这样解决办法为：

1. sleep 1s吧，喝个茶什么的等缓存失效…
2. 将Tenjin里的timestamp_interval参数由原1s,改为一个更小的值，0.001什么的。小手术。
3. 给Tenjin添加个属性，记住文件大小，在文件大小改变时，总是重新生成缓存。大手术啊~~~~
4. 动态生成的模板，别用同样的文件名.

1会带来时间浪费，测试中生成50+ html文件才半秒不到，不能浪费2倍的生命。
2，3都要改动Tenjin,通用性不好。
4算比较满意的，会稍提高点代码的复杂度。

BTW,如果要压榨性能，通过2中将值改大，或者3增加文件大小检查，模板文件不变时直接用.cache文件，应该有不少的性能提升。
