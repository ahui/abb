<!doctype html>
<html>
<head>
  <meta charset="utf-8">
  <title>Netgear R6300v2上编译ngrep</title>
  <link href="../css/main.css" rel="stylesheet" type="text/css" />
  <link href="../css/960.css" rel="stylesheet" type="text/css" />
  <style type="text/css" id="custom-background-css">
  body.custom-background { background-color: #e9e9e9; background-image: url('bg-pattern.png'); background-repeat: repeat; background-position: top left; background-attachment: fixed; }
  </style>
</head>
<body class="single single-post postid-1342 single-format-standard custom-background">
  <div class="wrapper">  

    <div id="header">      
      <div class="container_16 clearfix">
        <div class="grid_16">
          <div id="headimg">
            <div id="logo-text">
              <span class="site-name"><a href="http://ahui.us/" title="Ahui的个人博客" rel="home">Ahui的个人博客</a></span>
              <span class="site-description">&#8211;Since 2010 by Ahui.</span>
            </div>
          </div>     
        </div>
      </div>     
    </div>

    <div class="container_16 clearfix">
      <div id="nav" class="grid_16">
        <div class="menu clearfix">
          <ul>
            <li class="page_item page-item-2"><a href="http://ahui.us/index.php/about/">About</a></li>
            <li class="page_item page-item-7"><a href="http://ahui.us/index.php/aboutahui/">关于Ahui</a></li>
          </ul>
        </div>
      </div>
    </div>


    <div class="container_16 clearfix">

      <div class="grid_11">
        <div id="content">    
          <div class="post type-post status-publish format-standard hentry">
            <div class="entry-meta-group clearfix">
              <div class="grid_2 alpha">
                <time class="entry-date entry-time updated" datetime="2013-10-09 13:33:44">
                  <a href="#" title="2013-10-09 13:33:44" rel="bookmark">
                    <span class="entry-date-day">09</span>
                    <span class="entry-date-month-year">2013-10</span>
                  </a>
                </time>
              </div>
                <div class="grid_8 omega">
                  <h1 class="entry-title entry-title-single">Netgear R6300v2上编译ngrep</h1>
                  <div class="entry-meta">    
                    <span class="entry-meta-sep"><a href="http://ahui.us/" title="Ahui">Ahui</a> &sdot;</span>
                  <span class="tag-links">
                    <span class="entry-utility-prep entry-utility-prep-tag-links">Tagged:</span>
                    <a href="../tag/Linux.html" rel="tag">Linux</a>
                    <a href="../tag/Network.html" rel="tag">Network</a>
                  </span>
                  </div>
                  </div>
                </div>

                <div class="entry-content clearfix">
                  <p><p>R6300v2的dd-wrt已经<a href="http://www.myopenrouter.com/download/50404/DD-WRT-for-R6300v2">有一个版本可用</a>，但可惜wifi接入还是有问题，只好换回原厂固件。打算稍修改一下原厂固件，让它能自动运行usb设备上指定目录下的脚本，这样暂时没有好用的dd-wrt的时候，可以满足现有的大部分情况。</p>

<p>第一步，则是要先完成能用的编译环境，并能成功编译出能在R6300v2上运行的程序。因为常用ngrep，所以第一步则以编译能用的ngrep为目标.</p>

<p><a href="http://wikidevi.com/wiki/Netgear_R6300_v2">R6300v2硬件参数</a></p>

<p>工具链是hndtools-arm-linux-2.6.36-uclibc-4.5.3,和R6250的一样，可以下载<a href="ftp://downloads.netgear.com/files/GPL/R6250-V1.0.0.62_with_toolchain_source.zip">R6250的原代码</a>，取得工具链。并顺便下载<a href="ftp://downloads.netgear.com/files/GPL/R6300v2-V1.0.1.72_1.0.21-src.tar.zip">R6300的源代码</a>备用.</p>

<p>主系统为ubuntu 12.04 32位，创建/projects/hnd/tools/linux目录，并解压R6250源码包中的hndtools-arm-linux-2.6.36-uclibc-4.5.3.tar到此目录。</p>

<p>将新编译工具目录放到PATH环境的最前面:
<code>bash
export PATH=/projects/hnd/tools/linux/hndtools-arm-linux-2.6.36-uclibc-4.5.3/bin:$PATH
</code></p>

<p>下载libpcap-1.4.0.tar.gz及ngrep-1.45.tar并解压。</p>

<p>编译libpcap: 
<code>bash
./configure CC=arm-uclibc-linux-2.6.36-gcc --host=arm-linux --with-pcap=linux &amp;&amp; make
</code>
编译ngrep: 
<code>bash
./configure CC=arm-uclibc-linux-2.6.36-gcc CXX=arm-uclibc-linux-2.6.36-g++ AR=arm-uclibc-linux-2.6.36-ar RANLIB=arm-uclibc-linux-2.6.36-ranlib LD=arm-uclibc-linux-2.6.36-ld  --prefix=/usr/local/arm/ngrep --host=arm-linux --build=arm --with-pcap-includes=../libpcap-1.4.0 &amp;&amp; make
</code></p>

<p>检查编译出来的文件:
<code>bash
file ngrep
ngrep: ELF 32-bit LSB executable, ARM, version 1 (SYSV), dynamically linked (uses shared libs), stripped
</code></p>

<p>开启R6300v2的telnet(R6300v2 ip为192.168.1.1)
下载<a href="https://code.google.com/p/netgear-telnetenable/">telnetenable.py</a>
<code>bash
python telnetenable.py 192.168.1.1 $(arp -n | awk &quot;/192.168.1.1/&quot;&#39;  { gsub(/:/, &quot;&quot;, $3); print toupper($3)}&#39;) Gearguy Geardog
</code>
出现&quot;Sent telnet enable payload to &#39;192.168.1.1:23&#39;&quot;则成功，否则多运行几次.</p>

<p>将ngrep copy到u盘，并在R6300上挂载，然后telnet到R6300v2,到/tmp/mnt/usb0/part1下找到ngrep并运行之。
<code>bash
./ngrep -V
ngrep: V1.45, $Revision: 1.93 $
</code></p>
</p>
                </div>

                </div>

                  </div> 
                </div> 

                <div class="grid_5">

                  <div id="sidebar">
                    <div class="widget widget_search widget-widget_search">
                      <div class="widget-wrap widget-inside">
                        <div class="search">
                          <form method="get" class="searchform" action="http://ahui.us/">
                            <label for="s" class="assistive-text">Search for:</label>
                            <input type="text" class="field" name="s" id="s" value="Search" onfocus="if(this.value==this.defaultValue)this.value='';" onblur="if(this.value=='')this.value=this.defaultValue;" />
                            <input type="submit" class="submit" name="submit" id="searchsubmit" value="Search" />
                          </form>
                        </div>
                      </div>
                    </div>


                    <div class="widget widget_categories widget-widget_categories">
                      <div class="widget-wrap widget-inside">
                        <h3 class="widget-title">标签</h3>
                        <ul>
                          <li class="cat-item"><a href="../tag/sip.html">sip &sdot; (2)</a></li>
                          <li class="cat-item"><a href="../tag/Network.html">Network &sdot; (48)</a></li>
                          <li class="cat-item"><a href="../tag/VPS.html">VPS &sdot; (3)</a></li>
                          <li class="cat-item"><a href="../tag/openerp.html">openerp &sdot; (2)</a></li>
                          <li class="cat-item"><a href="../tag/wow.html">wow &sdot; (1)</a></li>
                          <li class="cat-item"><a href="../tag/ipv6.html">ipv6 &sdot; (2)</a></li>
                          <li class="cat-item"><a href="../tag/wii.html">wii &sdot; (3)</a></li>
                          <li class="cat-item"><a href="../tag/blog.html">blog &sdot; (19)</a></li>
                          <li class="cat-item"><a href="../tag/game.html">game &sdot; (5)</a></li>
                          <li class="cat-item"><a href="../tag/ssh.html">ssh &sdot; (2)</a></li>
                          <li class="cat-item"><a href="../tag/Linux.html">Linux &sdot; (35)</a></li>
                          <li class="cat-item"><a href="../tag/android.html">android &sdot; (1)</a></li>
                          <li class="cat-item"><a href="../tag/sofeware.html">sofeware &sdot; (3)</a></li>
                        </ul>
                    </div>
                  </div>

                  <div class="widget widget_recent_entries widget-widget_recent_entries">
                    <div class="widget-wrap widget-inside">
                      <h3 class="widget-title">最新文章</h3>
                      <ul> 
                        <li><a href='openerp-7-add-menu.html'>OPENERP 7:菜单添加</a></li>
                        <li><a href='tips-upload-with-web-py.html'>Tips : upload with web.py</a></li>
                        <li><a href='netgear-r6300v2-ngrep.html'>Netgear R6300v2上编译ngrep</a></li>
                        <li><a href='test-100m.html'>联通100M体验</a></li>
                        <li><a href='iphone-5-clean.html'>Iphone 5可用容量恢复</a></li>
                      </ul>
                    </div>
                  </div>
                </div>
              </div>

            </div>

            <div class="container_16 containter_footer">
              <div id="footer" class="grid_16">
                <div class="grid_10 alpha">
                  <div class="copyright_inside">
                    &copy; Copyright 2014 - <a href="http://ahui.us/">Ahui的个人博客</a>  </div>
                  </div>
                  <div class="grid_6 omega">
                    <div class="credit_inside">
                      <a href="http://designorbital.com/contango/" title="Contango Theme">Contango Theme</a> &sdot; Modifiy by <a href="http://ahui.us/" title="Ahui">Ahui</a>
                    </div>
                  </div>
                </div>
              </div>

            </div>
          </body>
          </html>
